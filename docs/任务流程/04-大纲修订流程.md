# å¤§çº²ä¿®è®¢æµç¨‹

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°ç¬”è®°æœ¬å¤§çº²ä¿®è®¢çš„æµç¨‹ï¼ŒåŒ…æ‹¬ä¿®æ”¹ç« èŠ‚æ ‡é¢˜ã€æè¿°ã€æ·»åŠ /åˆ é™¤ç« èŠ‚ç­‰æ“ä½œã€‚

## ğŸ“‹ æµç¨‹æ¦‚è§ˆ

å¤§çº²ä¿®è®¢æ˜¯åœ¨ç¬”è®°æœ¬åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·å¯¹ç”Ÿæˆçš„å¤§çº²ä¸æ»¡æ„ï¼Œéœ€è¦ä¿®æ”¹çš„åœºæ™¯ã€‚ä¸»è¦æ¶‰åŠï¼š
- **å¤§çº²ä¿®æ”¹**ï¼šä¿®æ”¹ç°æœ‰ç« èŠ‚çš„æ ‡é¢˜å’Œæè¿°
- **ç« èŠ‚ç®¡ç†**ï¼šæ·»åŠ ã€åˆ é™¤ç« èŠ‚
- **é¡ºåºè°ƒæ•´**ï¼šè°ƒæ•´ç« èŠ‚é¡ºåº

## ğŸ¯ åœºæ™¯ï¼šå¤§çº²ä¿®è®¢

### è§¦å‘æ–¹å¼ï¼š**By Tool** â†’ **Agent as Tool**

### è¯¦ç»†æµç¨‹

```
ç”¨æˆ·å¯¹ç”Ÿæˆçš„å¤§çº²ä¸æ»¡æ„
    â†“
TopLevelAgent æ¥æ”¶ä¿®è®¢è¯·æ±‚
    â†“
è°ƒç”¨ outline_revision_agent (Agent as Tool)
    â†“
OutlineRevisionAgent åˆ†æå½“å‰å¤§çº²å’Œç”¨æˆ·åé¦ˆ
    â†“
æ ¹æ®åé¦ˆä¿®æ”¹å¤§çº²ï¼š
  - ä¿®æ”¹ç« èŠ‚æ ‡é¢˜å’Œæè¿°
  - æ·»åŠ æ–°ç« èŠ‚
  - åˆ é™¤ç« èŠ‚
  - è°ƒæ•´ç« èŠ‚é¡ºåº
    â†“
è¿”å›ä¿®æ”¹åçš„ Outline å¯¹è±¡
    â†“
ç”¨æˆ·ç¡®è®¤åï¼Œä½¿ç”¨æ–°å¤§çº²åˆ›å»ºç¬”è®°æœ¬
```

### å…³é”® Agent

#### `outline_revision_agent` (Agent as Tool)
- **ä½ç½®**ï¼š`backend/tools/agent_as_tools/OutlineRevisionAgent.py`
- **åŠŸèƒ½**ï¼šæ ¹æ®ç”¨æˆ·åé¦ˆä¿®æ”¹ç°æœ‰å¤§çº²
- **è¾“å…¥**ï¼š
  - `current_outline`ï¼šå½“å‰çš„å¤§çº²å¯¹è±¡
  - `user_feedback`ï¼šç”¨æˆ·çš„åé¦ˆæ„è§
- **è¾“å‡º**ï¼šä¿®æ”¹åçš„ Outline å¯¹è±¡

**æ”¯æŒçš„æ“ä½œ**ï¼š
1. **ä¿®æ”¹ç« èŠ‚æ ‡é¢˜å’Œæè¿°**ï¼šæ ¹æ®ç”¨æˆ·è¦æ±‚è°ƒæ•´ç« èŠ‚å†…å®¹
2. **æ·»åŠ æ–°ç« èŠ‚**ï¼šåœ¨æŒ‡å®šä½ç½®æ·»åŠ æ–°ç« èŠ‚
3. **åˆ é™¤ç« èŠ‚**ï¼šç§»é™¤ä¸éœ€è¦çš„ç« èŠ‚
4. **è°ƒæ•´é¡ºåº**ï¼šé‡æ–°æ’åˆ—ç« èŠ‚é¡ºåº
5. **é‡æ–°ç”Ÿæˆ**ï¼šæ ¹æ®åé¦ˆå®Œå…¨é‡æ–°ç”Ÿæˆå¤§çº²

### ä»£ç ç¤ºä¾‹

```python
# TopLevelAgent ä½¿ç”¨ outline_revision_agent
from backend.tools.tool_registry import get_tool_registry
from agents import Runner

registry = get_tool_registry()

# åˆ›å»º outline_revision_agent å·¥å…·
revision_tool = registry.create_tool(
    "outline_revision_agent",
    agent=top_level_agent,
    current_outline=current_outline,
    user_feedback=user_feedback
)

# è¿è¡Œä¿®è®¢
revised_result = await Runner.run(
    revision_tool._agent_instance,
    f"è¯·æ ¹æ®ä»¥ä¸‹åé¦ˆä¿®æ”¹å¤§çº²ï¼š{user_feedback}"
)

# è·å–ä¿®è®¢åçš„å¤§çº²
revised_outline = revised_result.final_output
```

## ğŸ“Š å®Œæ•´æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·æŸ¥çœ‹å¤§çº²     â”‚
â”‚ æå‡ºä¿®æ”¹æ„è§     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TopLevelAgent   â”‚
â”‚                 â”‚
â”‚ æ¥æ”¶ä¿®è®¢è¯·æ±‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ outline_        â”‚
â”‚ revision_agent  â”‚
â”‚ (Agent as Tool) â”‚
â”‚                 â”‚
â”‚ 1. åˆ†æåé¦ˆ      â”‚
â”‚ 2. è¯†åˆ«ä¿®æ”¹ç‚¹    â”‚
â”‚ 3. æ‰§è¡Œä¿®æ”¹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›ä¿®è®¢åå¤§çº²   â”‚
â”‚                 â”‚
â”‚ 1. ä¿®æ”¹çš„ç« èŠ‚    â”‚
â”‚ 2. æ–°å¢çš„ç« èŠ‚    â”‚
â”‚ 3. åˆ é™¤çš„ç« èŠ‚    â”‚
â”‚ 4. è°ƒæ•´çš„é¡ºåº    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç¡®è®¤         â”‚
â”‚                 â”‚
â”‚ ç¡®è®¤ååˆ›å»ºç¬”è®°æœ¬ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ä¸åˆ›å»ºæµç¨‹çš„é›†æˆ

å¤§çº²ä¿®è®¢é€šå¸¸å‘ç”Ÿåœ¨ç¬”è®°æœ¬åˆ›å»ºæµç¨‹çš„ä¸­é—´é˜¶æ®µï¼š

```
1. ç”Ÿæˆåˆå§‹å¤§çº²
   â†“
2. ç”¨æˆ·æŸ¥çœ‹å¤§çº²
   â†“
3. ç”¨æˆ·æå‡ºä¿®æ”¹æ„è§ï¼ˆå¯é€‰ï¼‰
   â†“
4. è°ƒç”¨ outline_revision_agent ä¿®è®¢
   â†“
5. ç”¨æˆ·ç¡®è®¤ä¿®è®¢åçš„å¤§çº²
   â†“
6. ä½¿ç”¨ç¡®è®¤çš„å¤§çº²åˆ›å»ºå®Œæ•´ç¬”è®°æœ¬
```

### åœ¨ create_notebook_from_outline ä¸­çš„ä½¿ç”¨

```python
# åœ¨ create_notebook_from_outline å·¥å…·ä¸­
# å¦‚æœç”¨æˆ·æä¾›äº†ä¿®è®¢åé¦ˆï¼Œå…ˆä¿®è®¢å¤§çº²
if revision_feedback:
    revision_tool = registry.create_tool(
        "outline_revision_agent",
        agent=master_agent,
        current_outline=outline,
        user_feedback=revision_feedback
    )
    
    revised_result = await Runner.run(
        revision_tool._agent_instance,
        f"è¯·æ ¹æ®ä»¥ä¸‹åé¦ˆä¿®æ”¹å¤§çº²ï¼š{revision_feedback}"
    )
    
    outline = revised_result.final_output  # ä½¿ç”¨ä¿®è®¢åçš„å¤§çº²
```

## ğŸ”‘ å…³é”®è¦ç‚¹

1. **ä¿æŒé€»è¾‘æ€§**ï¼šä¿®è®¢æ—¶ç¡®ä¿ç« èŠ‚ä¹‹é—´ä¸é‡å¤ã€ä¸é—æ¼
2. **è¾¹ç•Œæ¸…æ™°**ï¼šæ¯ä¸ªç« èŠ‚çš„è¾¹ç•Œåº”è¯¥æ¸…æ™°ï¼Œå†…å®¹ä¸é‡å 
3. **ç”¨æˆ·æ„å›¾ç†è§£**ï¼šå‡†ç¡®ç†è§£ç”¨æˆ·çš„åé¦ˆæ„å›¾
4. **æ¸è¿›å¼ä¿®æ”¹**ï¼šå¦‚æœç”¨æˆ·æ²¡æœ‰æ˜ç¡®è¦æ±‚ä¿®æ”¹æŸäº›éƒ¨åˆ†ï¼Œåˆ™ä¿æŒåŸæ ·
5. **ç»“æ„åŒ–è¾“å‡º**ï¼šè¿”å›çš„ä»ç„¶æ˜¯ç»“æ„åŒ–çš„ Outline å¯¹è±¡

## ğŸ› å¸¸è§é—®é¢˜

### Q: å¤§çº²ä¿®è®¢ä¼šå½±å“å·²åˆ›å»ºçš„ç« èŠ‚å†…å®¹å—ï¼Ÿ
A: ä¸ä¼šã€‚å¤§çº²ä¿®è®¢åªå‘ç”Ÿåœ¨åˆ›å»ºå®Œæ•´å†…å®¹ä¹‹å‰ã€‚å¦‚æœéœ€è¦åœ¨åˆ›å»ºåä¿®æ”¹ï¼Œåº”è¯¥ä½¿ç”¨å†…å®¹ä¿®æ”¹æµç¨‹ã€‚

### Q: å¯ä»¥å¤šæ¬¡ä¿®è®¢å¤§çº²å—ï¼Ÿ
A: å¯ä»¥ã€‚æ¯æ¬¡ä¿®è®¢éƒ½ä¼šåŸºäºå½“å‰å¤§çº²å’Œæ–°çš„åé¦ˆè¿›è¡Œä¿®æ”¹ã€‚

### Q: å¦‚ä½•ç¡®ä¿ä¿®è®¢åçš„å¤§çº²è´¨é‡ï¼Ÿ
A: `outline_revision_agent` ä¼šï¼š
- æ£€æŸ¥ç« èŠ‚ä¹‹é—´çš„é€»è¾‘å…³ç³»
- ç¡®ä¿ç« èŠ‚è¾¹ç•Œæ¸…æ™°
- ä¿æŒå¤§çº²çš„å®Œæ•´æ€§
- æ ¹æ®ç”¨æˆ·åé¦ˆè¿›è¡Œç²¾ç¡®ä¿®æ”¹

### Q: ä¿®è®¢åå¦‚ä½•åº”ç”¨åˆ°ç¬”è®°æœ¬åˆ›å»ºï¼Ÿ
A: ä¿®è®¢åçš„å¤§çº²ä¼šæ›¿æ¢åŸæ¥çš„å¤§çº²ï¼Œç„¶åç»§ç»­ä½¿ç”¨ `create_notebook_from_outline` åˆ›å»ºå®Œæ•´ç¬”è®°æœ¬ã€‚

