"""Common prompt snippets - 公共 prompt 片段

这些片段可以在多个 Agent 的 prompt 中复用，避免重复代码。
使用时直接 import 并插入到 instructions 中。
"""

# ============================================================================
# 题目类型要求
# ============================================================================

QUESTION_TYPE_REQUIREMENTS = """
**题目类型要求（examples 和 exercises 都必须使用以下5种类型之一）**

1. **选择题 (multiple_choice)**：
   - question_type="multiple_choice"
   - question: 题目内容
   - options: 4个选项的列表
   - correct_answer: "A", "B", "C", 或 "D"
   - explanation: 解释为什么选择这个答案

2. **填空题 (fill_blank)**：
   - question_type="fill_blank"
   - question: 题目内容，使用占位符如 [空1]、[空2] 等
   - blanks: 字典格式 {"[空1]": "答案1", "[空2]": "答案2"}
   - explanation: 解释

3. **证明题 (proof)**：
   - question_type="proof"
   - question: 需要证明的命题
   - answer: 简要答案或结论
   - proof: 详细的证明步骤
   - explanation: 解释

4. **简答题 (short_answer)**：
   - question_type="short_answer"
   - question: 题目内容
   - answer: 正确答案
   - explanation: 详细解释

5. **代码题 (code)**：
   - question_type="code"
   - question: 题目内容
   - code_answer: 完整的代码答案
   - explanation: 代码解释（可选）

**重要**：
- 每个例子和练习都必须明确指定 question_type，不能为null
- 保持题目的多样性和合理性，根据内容特点选择合适的题目类型
"""

# ============================================================================
# 证明质量要求
# ============================================================================

PROOF_QUALITY_REQUIREMENTS = """
**证明质量要求（重要，必须严格遵守）**：

- 所有proof必须包含详细的中间步骤，不能跳过关键推理
- 必须明确引用使用的公式、定理、定义（要写出具体的公式内容，不能只说"根据公式"）
- 对于涉及计算的证明，必须展示详细的计算过程
- 每一步推理都要有清晰说明
- 使用标记使步骤清晰（如"步骤1"、"步骤2"或"(1)"、"(2)"）
- 证明必须完整详细，达到教学标准，便于初学者理解
- **所有数学符号、变量、集合等都必须用LaTeX公式标记包裹**
"""

# ============================================================================
# LaTeX 格式要求
# ============================================================================

LATEX_FORMAT_REQUIREMENTS = """
**LaTeX 格式要求（重要，必须严格遵守）**：

- **行内公式**：使用单个美元符号包裹，格式为 `$公式内容$`
- **块级公式**：使用两个美元符号包裹，格式为 `$$公式内容$$`
- **重要规则**：
  * 所有数学符号、变量、集合等都必须用LaTeX公式标记包裹
  * 不要在公式标记内外混用文本
  * 错误做法：直接写"有理数集 Q"
  * 正确做法："有理数集"后面跟公式标记包裹的数学符号，如"有理数集 $Q$"
  * 公式中不要有多余的换行，如果需要多行公式，使用适当的LaTeX环境（如 `align`、`matrix` 等）
"""

# ============================================================================
# 代码和数学公式格式要求
# ============================================================================

CODE_AND_MATH_FORMAT_REQUIREMENTS = """
**代码和数学公式格式要求（重要）**：

- **代码块**：所有代码必须使用 Markdown 代码块格式
  - 行内代码：使用反引号包裹，如 `code`
  - 代码块：使用三个反引号包裹，并指定语言，如：
    ```python
    code here
    ```

- **数学公式**：所有数学公式必须使用 LaTeX 格式
  - **行内公式**：使用单个美元符号包裹，格式为 `$公式内容$`
  - **块级公式**：使用两个美元符号包裹，格式为 `$$公式内容$$`
  - **重要规则**：所有数学符号、变量、集合等都必须在公式标记内
"""

# ============================================================================
# Section 输出结构说明
# ============================================================================

SECTION_OUTPUT_STRUCTURE = """
**输出结构**

返回一个 Section 对象，包含：

1. **introduction**（介绍）：为什么学习、有什么用、解决什么问题、在知识体系中的位置
   - **重要**：introduction字段只能包含介绍性文本，**不能包含例子、选择题、练习题、题目等任何需要答题的内容**

2. **concept_blocks**（概念块列表）：
   - **重要**：每个概念块必须包含一个 definition（定义）字段，这是必需字段，不能为空
   - 定义后面关联的 examples（例子列表，每个 Example 必须是以下5种题目类型之一）
   - 定义后面关联的 notes（笔记列表）
   - 定义后面关联的 theorems（定理列表，每个 Theorem 包含 theorem、proof、examples）

3. **standalone_examples**（独立例子，可选）

4. **standalone_notes**（独立笔记，可选）

5. **summary**（总结）：如何学好、常见误区、通用解题思路、证明格式、学习建议、关键要点

6. **exercises**（练习题）：每个练习必须是以下5种题目类型之一
"""

# ============================================================================
# 选择题优化要求
# ============================================================================

MULTIPLE_CHOICE_REQUIREMENTS = """
**选择题优化要求**（question_type = "multiple_choice"）：
- **必须**包含4个选项（options字段）
- **必须**指定正确答案（correct_answer: "A", "B", "C", 或 "D"）
- **必须**提供解释（explanation）
- 选项要求：
  * 4个选项必须合理，有干扰性
  * 正确答案必须正确
  * 干扰选项应该常见但错误
  * 选项格式统一，使用LaTeX格式（如需要）
"""

# ============================================================================
# 填空题优化要求
# ============================================================================

FILL_BLANK_REQUIREMENTS = """
**填空题优化要求**（question_type = "fill_blank"）：
- **必须**包含blanks字典，键与question中的占位符完全匹配
- **必须**提供explanation解释为什么填这些内容
- 如果question中没有占位符，需要添加占位符（如[空1]、[空2]）
"""

# ============================================================================
# 证明题优化要求
# ============================================================================

PROOF_EXERCISE_REQUIREMENTS = """
**证明题优化要求**（question_type = "proof"）：
- **必须**包含proof字段（详细证明步骤）
- **必须**包含answer字段（简要结论）
- proof要求：
  * 分步骤说明，使用标记（如"步骤1"、"步骤2"或"(1)"、"(2)"）
  * 明确引用使用的公式、定理、定义
  * 展示关键计算过程
  * 每一步都有清晰说明
"""

# ============================================================================
# 简答题优化要求
# ============================================================================

SHORT_ANSWER_REQUIREMENTS = """
**简答题优化要求**（question_type = "short_answer"）：
- **必须**包含answer字段
- **必须**包含explanation字段（详细解释）
"""

# ============================================================================
# 题目类型识别说明
# ============================================================================

QUESTION_TYPE_IDENTIFICATION = """
**题目类型识别**：
- 如果question_type为null，根据question内容智能识别类型
- 选择题关键词："下列哪个"、"哪个是"、"选择"、"Which of the following"等
- 填空题关键词：包含"[空1]"、"[空2]"等占位符
- 证明题关键词："证明"、"证明题"、"prove"、"show that"等
- 默认：简答题（short_answer）
"""

# ============================================================================
# Concept Blocks 基本要求（通用）
# ============================================================================

CONCEPT_BLOCKS_BASIC_REQUIREMENTS = """
**concept_blocks 的基本要求**：
- **重要**：每个概念块必须包含一个 definition（定义）字段，这是必需字段，不能为空
"""

# ============================================================================
# Concept Blocks 详细要求（从零创建场景专用）
# ============================================================================

CONCEPT_BLOCKS_DETAILED_REQUIREMENTS_FROM_SCRATCH = """
**concept_blocks 的详细要求**（从零创建场景）：
- **⚠️ 这是最重要的部分，必须严格遵守**：
  * 你必须为章节描述中提到的每个核心概念创建一个 ConceptBlock
  * **每个概念块必须包含一个 definition（定义）字段，这是必需字段，不能为空**
  * **定义必须完整、准确，不能省略关键要素**
  * **每个定义后面必须关联 examples（例子列表），至少1-2个例子帮助理解**
  * **每个定义后面应该关联 notes（笔记列表），说明注意事项、常见误区等**
"""

# ============================================================================
# Exercises 详细要求（从零创建场景专用）
# ============================================================================

EXERCISES_DETAILED_REQUIREMENTS_FROM_SCRATCH = """
**exercises 的详细要求**（从零创建场景）：
- **⚠️ 重要：练习题必须多样化，不能只有一种类型**
- **必须包含**：
  * 选择题：至少1-2题，测试基础概念理解
  * 填空题：至少1-2题，测试定义记忆
  * 简答题：至少1-2题，测试概念理解
  * 证明题：根据章节内容决定，但不能只有证明题
  * 代码题：如果适用（如编程相关章节）
"""

